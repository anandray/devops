# build new binary, new image and push to GCR
docker build --force-rm  -t wolkinc/cloudstore .
docker tag wolkinc/cloudstore gcr.io/us-west1-wlk/wolkinc/cloudstore:v4
docker images
gcloud auth print-access-token | docker login -u oauth2accesstoken --password-stdin https://gcr.io
gcloud docker -- push gcr.io/us-west1-wlk/wolkinc/cloudstore:v4

# create ceph client using image
kubectl create -f cloudstore.yaml

# check pod creation, ssh into pod
kubectl get pods --namespace rook-ceph
kubectl --namespace rook-ceph exec -it cloudstore-78b597b6d4-4t7rc   bash


# deploy service
kubectl expose deployment -n rook-ceph wolk-storage --type=LoadBalancer --port 80 --target-port 80
kubectl get service -n rook-ceph

# delete service
kubectl delete -f cloudstore.yaml
kubectl delete service cloudstore
